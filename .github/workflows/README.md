# üöÄ GitHub Actions - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π –ø—Ä–æ–µ–∫—Ç–∞ DragonLost –Ω–∞ production —Å–µ—Ä–≤–µ—Ä –ø—Ä–∏ push –≤ –≤–µ—Ç–∫—É `main`.

---

## üìã –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### –®–∞–≥ 1: –î–æ–±–∞–≤—å—Ç–µ Secrets –≤ GitHub

–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è: **Settings ‚Üí Secrets and variables ‚Üí Actions ‚Üí New repository secret**

–°–æ–∑–¥–∞–π—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ —Å–µ–∫—Ä–µ—Ç—ã:

| –ò–º—è —Å–µ–∫—Ä–µ—Ç–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------------|----------|----------|
| `SERVER_IP` | `31.130.135.146` | IP –∞–¥—Ä–µ—Å —Å–µ—Ä–≤–µ—Ä–∞ |
| `SERVER_USERNAME` | `root` | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–ª—è SSH |
| `SERVER_PASSWORD` | `sVYPjmX1N1-R8k` | –ü–∞—Ä–æ–ª—å –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞ |
| `PROJECT_PATH` | `/var/www/dragonlost` | –ü—É—Ç—å –∫ –ø—Ä–æ–µ–∫—Ç—É –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ |

**‚ö†Ô∏è –í–ê–ñ–ù–û**: –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∫–æ–º–º–∏—Ç—å—Ç–µ —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ –≤ Git!

---

## üîÑ –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫

Workflow –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏:
- ‚úÖ Push –≤ –≤–µ—Ç–∫—É `main`
- ‚úÖ Merge Pull Request –≤ `main`

### –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫

–ú–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –≤—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ GitHub UI:
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Actions**
2. –í—ã–±–µ—Ä–∏—Ç–µ **Deploy to Production**
3. –ù–∞–∂–º–∏—Ç–µ **Run workflow**

---

## üìä –ü—Ä–æ—Ü–µ—Å—Å –¥–µ–ø–ª–æ—è

```
1. üöÄ –ù–∞—á–∞–ª–æ –¥–µ–ø–ª–æ—è
   ‚Üì
2. üì• Checkout code
   ‚Üì
3. üîß Setup Node.js
   ‚Üì
4. üîê SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É
   ‚Üì
5. üìÇ –ü–µ—Ä–µ—Ö–æ–¥ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞
   ‚Üì
6. üì• Git pull (–ø–æ–ª—É—á–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
   ‚Üì
7. üì¶ npm install (—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π)
   ‚Üì
8. üî® npm build (—Å–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞)
   ‚Üì
9. üîÑ PM2 restart (–ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è)
   ‚Üì
10. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
```

–û–±—â–µ–µ –≤—Ä–µ–º—è: **~3-5 –º–∏–Ω—É—Ç**

---

## üìù –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –û–±—ã—á–Ω—ã–π workflow —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:

```bash
# 1. –í–Ω–µ—Å–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
git add .
git commit -m "feat: –¥–æ–±–∞–≤–ª–µ–Ω–∞ –Ω–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è"

# 2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –≤ GitHub
git push origin main

# 3. GitHub Actions –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–¥–µ–ø–ª–æ–∏—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä!
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –¥–µ–ø–ª–æ—è:

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–∞ GitHub
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤–æ –≤–∫–ª–∞–¥–∫—É **Actions**
3. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ —Å—Ç–∞—Ç—É—Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ workflow

---

## üîç –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤

### –í GitHub:
1. **Actions** ‚Üí –≤—ã–±–µ—Ä–∏—Ç–µ –ø–æ—Å–ª–µ–¥–Ω–∏–π –∑–∞–ø—É—Å–∫
2. –ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ job **Deploy to Ubuntu Server**
3. –†–∞–∑–≤–µ—Ä–Ω–∏—Ç–µ —à–∞–≥–∏ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ª–æ–≥–æ–≤

### –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ:
```bash
ssh root@31.130.135.146
pm2 logs dragonlost-backend
pm2 logs dragonlost-frontend
```

---

## ‚ùå –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: "Host key verification failed"

**–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤—å—Ç–µ `StrictHostKeyChecking=no` –≤ SSH –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–ª–∏ –¥–æ–±–∞–≤—å—Ç–µ host key –≤ known_hosts.

–í workflow —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `appleboy/ssh-action` –∫–æ—Ç–æ—Ä—ã–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç host key.

### –ü—Ä–æ–±–ª–µ–º–∞: "Permission denied"

**–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å `SERVER_USERNAME` –∏ `SERVER_PASSWORD` –≤ Secrets
- ‚úÖ SSH –¥–æ—Å—Ç—É–ø —Ä–∞–∑—Ä–µ—à–µ–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- ‚úÖ –ü–æ—Ä—Ç 22 –æ—Ç–∫—Ä—ã—Ç –≤ —Ñ–∞–π—Ä–≤–æ–ª–µ

### –ü—Ä–æ–±–ª–µ–º–∞: "Git pull failed"

**–†–µ—à–µ–Ω–∏–µ**: –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
```bash
cd /var/www/dragonlost
git status
git reset --hard
git pull origin main
```

### –ü—Ä–æ–±–ª–µ–º–∞: "PM2 not found"

**–†–µ—à–µ–Ω–∏–µ**: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ PM2 –≥–ª–æ–±–∞–ª—å–Ω–æ:
```bash
npm install -g pm2
```

### –ü—Ä–æ–±–ª–µ–º–∞: "Build failed"

**–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ GitHub Actions –∏ –∏—Å–ø—Ä–∞–≤—å—Ç–µ –æ—à–∏–±–∫–∏ –≤ –∫–æ–¥–µ.

---

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### ‚úÖ –•–æ—Ä–æ—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏:

1. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Secrets** - –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ —Ö—Ä–∞–Ω–∏—Ç–µ –ø–∞—Ä–æ–ª–∏ –≤ –∫–æ–¥–µ
2. **–û–≥—Ä–∞–Ω–∏—á—å—Ç–µ –¥–æ—Å—Ç—É–ø** - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤–º–µ—Å—Ç–æ root
3. **SSH –∫–ª—é—á–∏** - –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–ª—é—á–∏ –≤–º–µ—Å—Ç–æ –ø–∞—Ä–æ–ª–µ–π
4. **Branch protection** - –≤–∫–ª—é—á–∏—Ç–µ –∑–∞—â–∏—Ç—É –≤–µ—Ç–∫–∏ main

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SSH –∫–ª—é—á–µ–π (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):

–ù–∞ —Å–µ—Ä–≤–µ—Ä–µ:
```bash
# –°–æ–∑–¥–∞–π—Ç–µ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –¥–µ–ø–ª–æ—è
adduser deployer
usermod -aG sudo deployer

# –ù–∞—Å—Ç—Ä–æ–π—Ç–µ SSH –∫–ª—é—á
mkdir -p /home/deployer/.ssh
# –î–æ–±–∞–≤—å—Ç–µ –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á –≤ authorized_keys
```

–í GitHub Actions –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `SSH_PRIVATE_KEY` –≤–º–µ—Å—Ç–æ –ø–∞—Ä–æ–ª—è:
```yaml
- name: Deploy via SSH
  uses: appleboy/ssh-action@v1.0.0
  with:
    host: ${{ secrets.SERVER_IP }}
    username: deployer
    key: ${{ secrets.SSH_PRIVATE_KEY }}
    # password —É–±—Ä–∞—Ç—å
```

---

## üéØ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ Discord/Telegram

–î–æ–±–∞–≤—å—Ç–µ –≤ –∫–æ–Ω–µ—Ü workflow:

```yaml
- name: Notify Discord
  if: always()
  uses: sarisia/actions-status-discord@v1
  with:
    webhook: ${{ secrets.DISCORD_WEBHOOK }}
    status: ${{ job.status }}
    title: "–î–µ–ø–ª–æ–π DragonLost"
    description: "–î–µ–ø–ª–æ–π –∑–∞–≤–µ—Ä—à–µ–Ω —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º: ${{ job.status }}"
```

### –î–µ–ø–ª–æ–π —Ç–æ–ª—å–∫–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤

–î–æ–±–∞–≤—å—Ç–µ —É—Å–ª–æ–≤–∏–µ:

```yaml
on:
  push:
    branches:
      - main
    paths:
      - 'backend/**'
      - 'frontend/**'
      - 'package.json'
```

### Rollback –ø—Ä–∏ –æ—à–∏–±–∫–µ

–î–æ–±–∞–≤—å—Ç–µ —à–∞–≥ –æ—Ç–∫–∞—Ç–∞:

```yaml
- name: Rollback on failure
  if: failure()
  uses: appleboy/ssh-action@v1.0.0
  with:
    host: ${{ secrets.SERVER_IP }}
    username: ${{ secrets.SERVER_USERNAME }}
    password: ${{ secrets.SERVER_PASSWORD }}
    script: |
      cd /var/www/dragonlost
      git reset --hard HEAD~1
      npm run build
      pm2 restart all
```

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### GitHub Actions Badge

–î–æ–±–∞–≤—å—Ç–µ –≤ README.md:

```markdown
![Deploy Status](https://github.com/YOUR_USERNAME/dragonlost/workflows/Deploy%20to%20Production/badge.svg)
```

### Uptime Robot

–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–∞–π—Ç–∞:
- https://uptimerobot.com/
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏

---

## üîó –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [GitHub Actions Documentation](https://docs.github.com/en/actions)
- [SSH Action Documentation](https://github.com/appleboy/ssh-action)
- [PM2 Documentation](https://pm2.keymetrics.io/)

---

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ GitHub Actions
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (`pm2 logs`)
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–æ–≤ (`pm2 status`)

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: 11 —è–Ω–≤–∞—Ä—è 2026
